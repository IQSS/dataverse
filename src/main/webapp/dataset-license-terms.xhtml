<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:c="http://java.sun.com/jsp/jstl/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:o="http://omnifaces.org/ui"
     xmlns:jsf="http://xmlns.jcp.org/jsf">
<!-- TERMS -->
   <div class="text-right margin-bottom" 
        jsf:rendered="#{dataverseSession.user.authenticated and empty editMode
                        and permissionsWrapper.canIssueUpdateDatasetCommand(DatasetPage.dataset)}">
       <p:commandLink type="button" styleClass="btn btn-default" actionListener="#{DatasetPage.edit('LICENSE')}" 
                      update="@form,:messagePanel" oncomplete="javascript:post_edit_terms()" disabled="#{DatasetPage.locked}">
           <f:setPropertyActionListener target="#{DatasetPage.selectedTabIndex}" value="0" />
           <span class="glyphicon glyphicon-briefcase"/> #{bundle['file.dataFilesTab.terms.editTermsBtn']}
       </p:commandLink>
    </div>
    <div class="panel-group">
       <div class="panel panel-default">
           <div data-toggle="collapse" data-target="#panelCollapseTOU" class="panel-heading text-info">
               #{bundle['file.dataFilesTab.terms.list.termsOfUse.header']} &#160;<span class="glyphicon glyphicon-chevron-up"/>
           </div>
           <div id="panelCollapseTOU" class="collapse in">
               <p:fragment id="touFragment">
                   <o:importFunctions type="edu.harvard.iq.dataverse.util.MarkupChecker"/>
                   <div class="panel-body">
                       <div class="form-group">
                           <label for="metadata_Terms" class="col-sm-3 control-label">
                               <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.waiver.title']}">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfUse.waiver']}
                               </span>
                           </label>
                           <div class="col-sm-9">
                               <ui:fragment rendered="#{empty editMode}">
                                   <p class="help-block">
                                       <h:outputText value="#{bundle['file.dataFilesTab.terms.list.termsOfUse.waiver.txt.description']}" escape="false"/>
                                   </p>
                               </ui:fragment>
                               <ui:fragment rendered="#{empty editMode and termsOfUseAndAccess.license == 'NONE'}">
                                   <p><h:outputText value="#{bundle['file.dataFilesTab.terms.list.termsOfUse.no.waiver.txt']}" escape="false"/></p>
                               </ui:fragment>
                               <ui:fragment rendered="#{!empty editMode}">
                                   <p class="help-block"><h:outputText value="#{bundle['file.dataFilesTab.terms.list.termsOfUse.waiver.description']}" escape="false"/></p>
                                   <p:selectOneRadio id="options" value="#{termsOfUseAndAccess.license}">
                                       <f:selectItem itemLabel="#{bundle['file.dataFilesTab.terms.list.termsOfUse.waiver.select.CCO']}" itemValue="CC0" />
                                       <f:selectItem itemLabel="#{bundle['file.dataFilesTab.terms.list.termsOfUse.waiver.select.notCCO']}" itemValue="NONE" />
                                       <p:ajax update="touFragment" oncomplete="javascript:dataverseuser_page_rebind();" />
                                   </p:selectOneRadio>
                               </ui:fragment>
                               <ui:fragment rendered="#{termsOfUseAndAccess.license == 'CC0'}">
                                   <p>#{bundle['file.dataFilesTab.terms.list.termsOfUse.waiver.txt']} <img src="/resources/images/cc0.png" alt="CC0" class="waiver-CC0-inline"/></p>
                               </ui:fragment>
                           </div>
                       </div>
                       <div class="form-group" jsf:rendered="#{termsOfUseAndAccess.license != 'CC0'}">
                           <label for="metadata_TermsUse" class="col-sm-3 control-label">
                               <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.termsOfUse.title']}">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfUse.termsOfUse']}
                               </span>
                           </label>
                           <div class="col-sm-9">
                               <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.termsOfUse)}" escape="false" rendered="#{empty editMode}"/>
                               <ui:fragment rendered="#{!empty editMode}">
                                   <p class="help-block"><h:outputText value="#{bundle['file.dataFilesTab.terms.list.termsOfUse.termsOfUse.description']}" escape="false"/></p>
                                   <p:inputTextarea value="#{termsOfUseAndAccess.termsOfUse}" rows="5" cols="60" styleClass="form-control" />
                               </ui:fragment>
                           </div>
                       </div>

                       <!-- Additional Information -->
                       <div jsf:rendered="#{!empty editMode or empty editMode and (!empty termsOfUseAndAccess.confidentialityDeclaration 
                                            or !empty termsOfUseAndAccess.specialPermissions or !empty termsOfUseAndAccess.restrictions or !empty termsOfUseAndAccess.citationRequirements 
                                            or !empty termsOfUseAndAccess.depositorRequirements
                                            or !empty termsOfUseAndAccess.conditions or !empty termsOfUseAndAccess.disclaimer)}">
                           <p>
                               <a data-toggle="collapse" href="#collapseTOUAdditional" aria-expanded="false" aria-controls="collapseExample">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo']} [+]
                               </a>
                           </p>
                           <div class="collapse" id="collapseTOUAdditional" jsf:rendered="#{empty editMode}">
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.confidentialityDeclaration}">
                                   <label for="confidentialityDeclaration" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.declaration.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.declaration']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.confidentialityDeclaration)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.specialPermissions}">
                                   <label for="specialPermissions" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.permissions.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.permissions']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.specialPermissions)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.restrictions}">
                                   <label for="restrictions" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.restrictions.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.restrictions']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.restrictions)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.citationRequirements}">
                                   <label for="citationRequirements" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.citationRequirements.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.citationRequirements']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.citationRequirements)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.depositorRequirements}">
                                   <label for="depositorRequirements" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.depositorRequirements.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.depositorRequirements']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.depositorRequirements)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.conditions}">
                                   <label for="conditions" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.conditions.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.conditions']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.conditions)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.disclaimer}">
                                   <label for="disclaimer" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.disclaimer.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.disclaimer']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.disclaimer)}" escape="false"/>
                                   </div>
                               </div>
                           </div>
                           <div class="collapse" id="collapseTOUAdditional" jsf:rendered="#{!empty editMode}">
                               <div class="form-group">
                                   <label for="confidentialityDeclaration" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.declaration.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.declaration']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea id="confidentialityDeclaration" value="#{termsOfUseAndAccess.confidentialityDeclaration}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="specialPermissions" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.permissions.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.permissions']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea id="specialPermissions" value="#{termsOfUseAndAccess.specialPermissions}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="restrictions" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.restrictions.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.restrictions']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea id="restrictions" value="#{termsOfUseAndAccess.restrictions}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="citationRequirements" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.citationRequirements.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.citationRequirements']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea id="citationRequirements" value="#{termsOfUseAndAccess.citationRequirements}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="depositorRequirements" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.depositorRequirements.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.depositorRequirements']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea id="depositorRequirements" value="#{termsOfUseAndAccess.depositorRequirements}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="conditions" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.conditions.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.conditions']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea id="conditions" value="#{termsOfUseAndAccess.conditions}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="disclaimer" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.disclaimer.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo.disclaimer']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea id="disclaimer" value="#{termsOfUseAndAccess.disclaimer}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                           </div>
                       </div>
                       <!-- END: Additional Information -->
                   </div>
               </p:fragment>
           </div>
       </div>

       <div class="panel panel-default" jsf:rendered="#{!empty editMode or empty editMode and (!empty termsOfUseAndAccess.termsOfAccess
                                                        or !empty termsOfUseAndAccess.dataAccessPlace 
                                        or !empty termsOfUseAndAccess.originalArchive or !empty termsOfUseAndAccess.availabilityStatus 
                                        or !empty termsOfUseAndAccess.contactForAccess or !empty termsOfUseAndAccess.sizeOfCollection 
                                        or !empty termsOfUseAndAccess.studyCompletion)}" >
           <div data-toggle="collapse" data-target="#panelCollapseTOA" class="panel-heading text-info">
               #{bundle['file.dataFilesTab.terms.list.termsOfAccess.header']} &#160;<span class="glyphicon glyphicon-chevron-up"/>
           </div>
           <div id="panelCollapseTOA" class="collapse in">
               <div class="panel-body">
                   <ui:fragment rendered="#{empty editMode}">
                       <ui:fragment rendered="#{empty editMode and datasetPage}">
                       <div class="form-group">
                           <label for="metadata_RestrictedFiles" class="col-sm-3 control-label">
                               <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.restrictedFiles.title']}">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfAccess.restrictedFiles']}
                               </span>
                           </label>
                           <div class="col-sm-9">
                               <p>
                                   <h:outputFormat value="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.restrictedFiles.txt']}">
                                       <f:param value="#{DatasetPage.restrictedFileCount}"/>
                                   </h:outputFormat>
                               </p>
                           </div>
                       </div>
                       </ui:fragment>
                       <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.termsOfAccess}">
                           <label for="metadata_TermsAccess" class="col-sm-3 control-label">
                               <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.termsOfsAccess.title']}">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfAccess.termsOfsAccess']}
                               </span>
                           </label>
                           <div class="col-sm-9">
                               <p><h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.termsOfAccess)}" escape="false"/></p>
                           </div>
                       </div>
                       <ui:fragment rendered="#{empty editMode and datasetPage}">
                       <div class="form-group" jsf:rendered="#{DatasetPage.restrictedFileCount > 0}">
                           <label for="metadata_RequestAccess" class="col-sm-3 control-label">
                               <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.requestAccess.title']}">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfAccess.requestAccess']}
                               </span>
                           </label>
                           <div class="col-sm-9">
                               <p>
                                   <h:outputText value="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.requestAccess.request']}" rendered="#{DatasetPage.dataset.fileAccessRequest}"/>
                                   <h:outputText value="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.requestAccess.notRequest']}" rendered="#{!DatasetPage.dataset.fileAccessRequest}"/>
                               </p>
                           </div>
                       </div>
                       </ui:fragment>
                   </ui:fragment>
                   <ui:fragment rendered="#{!empty editMode}">
                       <div class="form-group">
                           <label for="metadata_TermsAccess" class="col-sm-3 control-label">
                               <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.termsOfsAccess.title']}">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfAccess.termsOfsAccess']}
                               </span>
                           </label>
                           <div class="col-sm-9">
                               <p:inputTextarea value="#{termsOfUseAndAccess.termsOfAccess}" rows="5" styleClass="form-control" />
                       </div>
                       </div>
                       <div class="form-group">
                           <label for="metadata_RequestAccess" class="col-sm-3 control-label">
                               <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.requestAccess.title']}">
                                   #{bundle['file.dataFilesTab.terms.list.termsOfAccess.requestAccess']}
                               </span>
                           </label>
                           <div class="col-sm-9">
                               <p:selectBooleanCheckbox id="requestAccess" itemLabel="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.requestAccess.enableBtn']}" value="#{termsOfUseAndAccess.fileAccessRequest}"/>
                           </div>
                       </div>
                   </ui:fragment>

                   <!-- Additional Information -->
                   <div jsf:rendered="#{!empty editMode or empty editMode and (!empty termsOfUseAndAccess.dataAccessPlace 
                                        or !empty termsOfUseAndAccess.originalArchive or !empty termsOfUseAndAccess.availabilityStatus 
                                        or !empty termsOfUseAndAccess.contactForAccess or !empty termsOfUseAndAccess.sizeOfCollection 
                                        or !empty termsOfUseAndAccess.studyCompletion)}">
                       <p>
                           <a data-toggle="collapse" href="#collapseRestrictedFilesAdditional" aria-expanded="false" aria-controls="collapseExample">
                               #{bundle['file.dataFilesTab.terms.list.termsOfUse.addInfo']} [+]
                           </a>
                       </p>
                       <div class="collapse" id="collapseRestrictedFilesAdditional">
                           <ui:fragment rendered="#{empty editMode}">
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.dataAccessPlace}">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.dataAccessPlace.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.dataAccessPlace']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.dataAccessPlace)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.originalArchive}">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.originalArchive.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.originalArchive']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.originalArchive)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.availabilityStatus}">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.availabilityStatus.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.availabilityStatus']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.availabilityStatus)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.contactForAccess}">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.contactForAccess.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.contactForAccess']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.contactForAccess)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.sizeOfCollection}">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.sizeOfCollection.tip']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.sizeOfCollection']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.sizeOfCollection)}" escape="false"/>
                                   </div>
                               </div>
                               <div class="form-group" jsf:rendered="#{!empty termsOfUseAndAccess.studyCompletion}">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.studyCompletion.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.studyCompletion']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <h:outputText value="#{MarkupChecker:sanitizeBasicHTML(termsOfUseAndAccess.studyCompletion)}" escape="false"/>
                                   </div>
                               </div>
                           </ui:fragment>
                           <ui:fragment rendered="#{!empty editMode}">
                               <div class="form-group">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.dataAccessPlace.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.dataAccessPlace']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea value="#{termsOfUseAndAccess.dataAccessPlace}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.originalArchive.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.originalArchive']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea value="#{termsOfUseAndAccess.originalArchive}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.availabilityStatus.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.availabilityStatus']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea value="#{termsOfUseAndAccess.availabilityStatus}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.contactForAccess.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.contactForAccess']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea value="#{termsOfUseAndAccess.contactForAccess}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.sizeOfCollection.tip']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.sizeOfCollection']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea value="#{termsOfUseAndAccess.sizeOfCollection}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label for="metadata_TermsUse" class="col-sm-3 control-label">
                                       <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.studyCompletion.title']}">
                                           #{bundle['file.dataFilesTab.terms.list.termsOfAccess.addInfo.studyCompletion']}
                                       </span>
                                   </label>
                                   <div class="col-sm-9">
                                       <p:inputTextarea value="#{termsOfUseAndAccess.studyCompletion}" rows="5" cols="60" styleClass="form-control" />
                                   </div>
                               </div>
                           </ui:fragment>
                       </div>
                   </div>
                   <!-- END: Additional Information -->
               </div>
           </div>
       </div>

        <ui:fragment rendered="#{managePage==false or datasetPage == true}" >  
       <div class="panel panel-default" >
           <div data-toggle="collapse" data-target="#panelCollapseGuestbook" class="panel-heading text-info">
               #{bundle['file.dataFilesTab.terms.list.guestbook']} &#160;<span class="glyphicon glyphicon-chevron-up"/>
           </div>
           <div id="panelCollapseGuestbook" class="collapse in">
               <div class="panel-body">
                   <div class="form-group">
                       <label for="metadata_Guestbook" class="col-sm-3 control-label">
                           <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['file.dataFilesTab.terms.list.guestbook.title']}">
                               #{bundle['file.dataFilesTab.terms.list.guestbook']}
                           </span>
                       </label>
                       <div class="col-sm-9">
                           <ui:fragment rendered="#{empty editMode}">
                               <ui:fragment rendered="#{ datasetPage and empty DatasetPage.dataset.guestbook 
                                                        and ((!dataverseSession.user.authenticated or !permissionsWrapper.canIssueUpdateDatasetCommand(DatasetPage.dataset))
                                                        or ((dataverseSession.user.authenticated and permissionsWrapper.canIssueUpdateDatasetCommand(DatasetPage.dataset) 
                                                           and !empty DatasetPage.dataset.dataverseContext.availableGuestbooks)))}">
                                   <p>#{bundle['file.dataFilesTab.terms.list.guestbook.noSelected.tip']}</p>
                               </ui:fragment>
                               <ui:fragment rendered="#{empty DatasetPage.dataset.guestbook 
                                                 and (dataverseSession.user.authenticated and permissionsWrapper.canIssueUpdateDatasetCommand(DatasetPage.dataset))
                                                 and empty DatasetPage.dataset.dataverseContext.availableGuestbooks}">
                                   <p>
                                       <h:outputFormat value="#{bundle['file.dataFilesTab.terms.list.guestbook.noSelected.admin.tip']}">
                                           <f:param value="#{DatasetPage.dataset.owner.name}"/>
                                       </h:outputFormat>
                                   </p>
                               </ui:fragment>

                               <ui:fragment rendered="#{!empty DatasetPage.dataset.guestbook}">
                                   <p class="help-block">#{bundle['file.dataFilesTab.terms.list.guestbook.inUse.tip']}</p>
                                   <div class="panel panel-default">
                                       <div class="panel-body">
                                           <p class="form-control-static pull-left">#{DatasetPage.dataset.guestbook.name}</p>
                                           <p:commandLink type="button" styleClass="btn btn-default pull-right"
                                                          value="#{bundle['file.dataFilesTab.terms.list.guestbook.viewBtn']}"
                                                          action="#{DatasetPage.viewSelectedGuestbook(DatasetPage.dataset.guestbook)}"
                                                          update=":datasetForm" oncomplete="PF('viewGuestbook').show();bind_bsui_components();"/>
                                       </div>
                                   </div>
                               </ui:fragment>
                           </ui:fragment>

                           <ui:fragment rendered="#{!empty editMode and datasetPage}">
                               <p class="help-block">#{bundle['file.dataFilesTab.terms.list.guestbook.select.tip']}</p>

                               <ui:fragment rendered="#{empty DatasetPage.dataset.dataverseContext.availableGuestbooks}">
                                   <p class="help-block">
                                       <h:outputFormat value="#{bundle['file.dataFilesTab.terms.list.guestbook.noAvailable.tip']}">
                                           <f:param value="#{DatasetPage.dataset.owner.name}"/>
                                       </h:outputFormat>
                                   </p>
                               </ui:fragment>

                               <ui:fragment rendered="#{!empty DatasetPage.dataset.dataverseContext.availableGuestbooks}">
                                   <p:commandButton value="#{bundle['file.dataFilesTab.terms.list.guestbook.clearBtn']}" 
                                                    rendered="#{!empty DatasetPage.dataset.guestbook}"
                                                    update="guestbookTable" process="@this" actionListener="#{DatasetPage.reset}"/>
                                   <p:dataTable id="guestbookTable" styleClass="headerless-table margin-top"
                                                value="#{DatasetPage.dataset.dataverseContext.availableGuestbooks}" var="guestbook" widgetVar="guestbookTable"
                                                rendered="#{!empty DatasetPage.dataset.dataverseContext.availableGuestbooks}"
                                                rowIndexVar="rowNum" selection="#{DatasetPage.dataset.guestbook}" rowKey="#{guestbook}">
                                       <p:column  selectionMode="single" class="col-select-width text-center" rendered="true"  />
                                       <p:column>
                                           <p class="form-control-static pull-left">
                                               <h:outputText value="#{guestbook.name}" />
                                           </p>
                                           <p:commandLink type="button" styleClass="btn btn-default pull-right"
                                                          value="#{bundle['file.dataFilesTab.terms.list.guestbook.viewBtn']}"
                                                          action="#{DatasetPage.viewSelectedGuestbook(guestbook)}"
                                                          update=":datasetForm" oncomplete="PF('viewGuestbook').show();bind_bsui_components();"/>
                                       </p:column>
                                   </p:dataTable>
                               </ui:fragment>
                           </ui:fragment>
                       </div>
                   </div>
               </div>
           </div>
       </div>
       </ui:fragment>   
    </div>
    <!-- / TERMS -->

    <!-- View Guest Book -->
    <p:dialog id="viewGuestbook" styleClass="largePopUp" header="#{bundle['dataset.manageGuestbooks.tab.action.btn.view.dialog.header']}" widgetVar="viewGuestbook" modal="true">
        <div class="form-horizontal">
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['dataset.manageGuestbooks.tab.action.btn.view.dialog.datasetGuestbook.title']}">
                       #{bundle['dataset.manageGuestbooks.tab.action.btn.view.dialog.datasetGuestbook']}
                    </span>
                </label>
                <div class="col-sm-8">
                    <p class="form-control-static">
                     #{DatasetPage.selectedGuestbook.name}
                    </p>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <span data-toggle="tooltip" data-placement="auto right" class="tooltiplabel text-info" data-original-title="#{bundle['dataset.manageGuestbooks.tab.action.btn.view.dialog.userCollectedData.title']}">
                       #{bundle['dataset.manageGuestbooks.tab.action.btn.view.dialog.userCollectedData']}
                    </span>
                </label>
                <div class="col-sm-8">
                    <div class="form-control-static" jsf:rendered="#{!empty DatasetPage.selectedGuestbook.requiredAccountInformationString}">
                        <h:outputText value="#{DatasetPage.selectedGuestbook.requiredAccountInformationString}" escape="false"/>
                    </div>
                    <div class="form-control-static" jsf:rendered="#{!empty DatasetPage.selectedGuestbook.optionalAccountInformationString}">
                        <h:outputText value="#{DatasetPage.selectedGuestbook.optionalAccountInformationString}" escape="false"/>
                    </div>
                    <div class="form-control-static" jsf:rendered="#{!empty DatasetPage.selectedGuestbook.requiredCustomQuestionsString}">
                        <h:outputText value="#{DatasetPage.selectedGuestbook.requiredCustomQuestionsString}" escape="false"/>
                    </div>
                    <div class="form-control-static" jsf:rendered="#{!empty DatasetPage.selectedGuestbook.optionalCustomQuestionsString}">
                        <h:outputText value="#{DatasetPage.selectedGuestbook.optionalCustomQuestionsString}" escape="false"/>
                    </div>
                </div>
            </div>
        </div>
        <div class="button-block">
            <button type="button" onclick="PF('viewGuestbook').hide()" class="btn btn-default" value="#{bundle.close}">
                #{bundle.close}
            </button>
        </div>
    </p:dialog>
    <!-- / View Guest Book -->
</ui:composition>